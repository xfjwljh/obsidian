# 第1 章 计算机网络概论
主要内容：
* 计算机网络作用
* 互联网基础
* 网络的发展
* 互联网组成
* 主要类别
* 计算机网络性能指标
* 网络体系结构和协议

## 1.1 计算机网络在信息时代的作用
* 关于计算机网络的定义
  * 计算机网络是计算机技术和通信技术发展和结合的产物。
  * 使用*通信线路*把分布在不同地点的*计算机*连接起来，
  通过*通信协议*软件，达到相互*资源共享*的目的系统。

## 1.2 互联网概述
### 1.2.1. 网络的网络
   * 起源于美国的互联网现已发展成为世界上最大的国际性计算机互联网
   * *网络*(network)由若干*结点*(node)和连接这些结点的*链路*(link)组成。
   * 互联网是“网络的网络”(network of networks)。
   * 连接在互联网上的计算机都称为*主机*(host)。
 
 >* 请注意名词“结点”
 “结点”的英文名词是 node。
 网络中的 node 的标准译名是“结点”而不是“节点”。
  数据结构的树(tree)中的 node 应当译为“节点”。
  
  > 术语“互连” 一定不能用“互联”代替。

* 网络与互联网的区别
  * 网络把许多计算机连接在一起，从最小单元开始，例如实验室、宿舍、办公室的网络。
  *  互联网则把许多网络连接在一起，它是大规模网络，不是结点很多就可以叫做互联网。
![](2022-03-04-15-55-10.png)


### 1.2.2 互联网基础结构发展的三个阶段
* 第一阶段是从单个网络 ARPANET 向互联网发展的过程。
   * 1983 年 TCP/IP 协议成为 ARPANET 上的标准协议。
   * 人们把 1983 年作为互联网的诞生时间。
  >* internet 和 Internet 的区别
   以小写字母 i 开始的 internet（互连网）是一个通用名词，它泛指由多个计算机网络互连而成的网络。
    以大写字母I开始的的 Internet（因特网、互联网）则是一个专用名词，它指当前全球最大的、开放的、由众多网络相互连接而成的**特定计算机网络**，它采用 TCP/IP 协议族作为通信的规则，且其前身是美国的 ARPANET。
* 第二阶段的特点是建成了三级结构的互联网。
  * 三级计算机网络，分为主干网、地区网和校园网（或企业网）
    * 主干网链接各大洲，地区网链接各个城市，这种分级
* 第三阶段的特点是逐渐形成了多层次 ISP 结构的互联网。
  * 出现了互联网服务提供者 ISP (Internet Service Provider网络运营商)。如移动、联通
  * 用户不直接接入互联网，而是接入ISP，ISP再接入地区网/主干网
   ![](2022-03-04-16-03-58.png)
   ![](2022-03-04-16-04-48.png)
   ![](2022-03-04-16-06-04.png)
* ISP
  * ISP(Internet Service Provider)，互联网服务提供商，即向广大用户综合提供互联网接入业务、信息业务、和增值业务的电信运营商。ISP是经国家主管部门批准的正式运营企业，享受国家法律保护。
* NAP
  * NAP是互联网的路由选择层次体系中的通信交换点。每个网络接入点由一个共享交换系统或者局域网组成，用来交换业务量。
  * 通达因特网主干线的点。
  * ISP互相连接的点。
  * 1999年初NAP和城域交换局（MAE）被统称为公共互联网交换点（IXP）。
  * 有了NAP，访问时就不用一层层上到最顶了，NAP提供了一条快速通道
* 万维网 WWW 的问世
  * 大大方便了广大非网络专业人员对网络的使用，成为互联网的这种指数级增长的主要驱动力。

### 1.2.3 关于互联网的标准化工作
制订互联网的正式标准要经过以下的四个阶段
   1.  互联网草案(Internet Draft) ——在这个阶段还不是 RFC 文档。
   2.  建议标准(Proposed Standard) ——从这个阶段开始就成为 RFC 文档。
   3.  草案标准(Draft Standard)
   4.  互联网标准(Internet Standard) 

## 1.3 互联网的组成
* 根据互联网的工作方式，可以划分为两部分：
  * **边缘部分** 由所有连接在互联网上的主机组成。这部分是用户直接使用的，用来进行通信（传送数据、音频或视频）和资源共享。
    * 用户使用的部分
  * **核心部分** 由大量网络和连接这些网络的路由器组成。这部分是为边缘部分提供服务的（提供连通性和交换）
    * 维持网络正常工作的部分

### 1.3.1 互联网的边缘部分
* 互联网边缘的部分是连接在互联网上的所有的主机。主机又称为**端系统**(end system)。
* “主机 A 和主机 B 进行通信”：“运行在主机 A 上的某个*程序*和运行在主机 B 上的另一个*程序*进行*通信*”。

* 两种通信方式
 在网络边缘的端系统中运行的程序之间的通信方式通常可划分为两大类：
  * **客户服务器方式**（C/S 方式）即Client/Server方式
    * 一个服务器为多个客户端提供服务
    *  客户(client)和服务器(server)都是指通信中所涉及的两个应用进程。
    *  客户服务器方式所描述的是进程之间服务和被服务的关系。
    *  客户是服务的请求方，服务器是服务的提供方。
  ![](2022-03-04-16-29-52.png)
    * 客户软件的特点
      *  被用户调用后运行，在打算通信时主动向远地服务器发起通信（请求服务）。因此，客户程序必须知道服务器程序的地址。
      *  不需要特殊的硬件和很复杂的操作系统。
      *  浏览器、FTP工具、邮件客户端、APP…
  * 服务器软件的特点
    * 一种专门用来提供某种服务的程序，可同时处理多个远地或本地客户的请求。
    *  系统启动后即自动调用并**一直不断地运行**着，**被动地等待**并接受来自各地的客户的通信请求。因此，服务器程序不需要知道客户程序的地址。
    *  一般需要强大的硬件和高级的操作系统支持。

  * **对等方式**（P2P方式）即 Peer-to-Peer方式
    * **对等连接**(peer-to-peer，简写为 P2P)是指两个主机在通信时并不区分哪一个是服务请求方还是服务提供方。
    *  只要两个主机都运行了对等连接软件（P2P 软件），它们就可以进行平等的、对等连接通信。
    *   双方都可以下载对方已经存储在硬盘中的共享文档。
![](2022-03-04-16-33-41.png)

### 1.3.2 互联网的核心部分
* 作用：要向网络边缘中的大量主机提供连通性，使边缘部分中的任何一个主机都能够向其他主机通信（即传送或接收各种形式的数据）。
* 设备：**路由器**(router)。
* 路由器任务：实现**分组交换**(packet switching)的关键构件，其任务是**转发收到的分组**，这是网络核心部分最重要的功能
![](2022-03-04-16-37-32.png)
![](2022-03-04-16-37-46.png)
* “交换”的含义
  *  在这里，“**交换**”(switching)的含义就是转接——把一条电话线转接到另一条电话线，使它们连通起来。
   *   从通信资源的分配角度来看，“交换”就是按照某种方式**动态地分配**传输线路的资源。
*   电路交换的特点
    *   电路交换必定是面向连接的。
    *   电路交换的三个阶段：
        *   建立连接
        *   通信
        *   释放连接
* 电路交换举例：
  ![](2022-03-04-16-41-58.png)
>交换机的资源是有限的，如果同时有很多人同时通信，保证不了
另外，如果有一个交换机坏了，整个线路就没法用
C和D通过交换机交流，是一种资源浪费（绕了一大圈，如果直接通信会更顺畅）

* *电路交换*传送计算机数据效率低,因为：
  * 计算机数据具有突发性。
  * 导致通信线路的利用率很低

* 因此提出**分组交换**
  *  在发送端，先把较长的**报文**划分成*较短的、固定长度的数据。
![](2022-03-04-16-49-01.png)
  *  每一个数据段前面添加上首部(header)构成分组(packet)。
  ![](2022-03-04-16-50-05.png)
     * 分组交换网以“**分组**”作为数据传输单元。（此处有3分组，每个分组由首部+数据段组成。网络中数据传输的基本单元是分组）
       * 分组首部的重要性
         1. 每一个分组的首部都含有地址等控制信息。
         2. 分组交换网中的结点交换机根据收到的分组的首部中的地址信息，把分组转发到下一个结点交换机。
         3.  用这样的存储转发方式，最后分组就能到达最终目的地。
     *  依次把各分组发送到接收端（假定接收端在左边）。
  *  *接收端*收到分组后**剥去首部还原**成报文。
     *   这里我们假定分组在传输过程中没有出现差错，在转发时也没有被丢弃。

* 主机和路由器
  * 互联网的核心部分是由许多*网络*和把它们互连起来的 *组成，而*主机处在互联网的边缘部分。*
  * 在互联网**核心**部分的路由器之间一般都用**高速**链路相连接，而在网络**边缘**的主机接入到核心部分则通常以相对**较低速率**的链路相连接。
  * **主机**的用途是为用户进行信息处理的，并且可以和其他主机通过网络交换信息。**路由器**的用途则是用来转发分组的，即进行分组交换的

* 路由器的存储转发
  * 在路由器中的输入和输出端口之间没有直接连线。
  * 路由器处理分组的过程是：
    1. 把收到的分组先放入*缓存*（暂时存储）；
    2.  查找**转发表**（IP地址和本地端口的对应表），找出到某个目的地址应从哪个端口转发；
    3.   把分组送到适当的*端口*转发出去。

* 分组交换的优点
  *  *高效* ：动态分配传输带宽，对通信链路是逐段占用（电路交换是一下占据整条链路）。
  *  *灵活* ：以分组为传送单位和查找路由。
  *   *迅速* ：不必先建立连接就能向其他主机发送分组。（可以并行发送信息）
  *    *可靠* ：保证可靠性的网络协议；分布式的路由选择协议使网络有很好的生存性。（路由器可以自行选择路径，避开不可用的路由器）
*    分组交换带来的问题
     *    分组在各结点存储转发时需要*排队*，这就会造成一定的*时延*。（路由器的缓存有限，当通信量大时需要排队，人多网卡）
     *    分组必须携带的首部（里面有必不可少的控制信息）也造成了一定的*开销*。

* 存储转发
![](2022-03-04-17-23-08.png)
报文交换和分组交换都采用了存储转发的原理，但还是有区别。前者已经基本不用。Q

![](2022-03-04-17-30-03.png)

## 1.5 计算机网络的分类
### 1.5.1定义
* 计算机网络的不同定义：
  *  最简单的定义：计算机网络是一些互相连接的、自治的计算机的集合。
  *  较好的定义：计算机网络主要是由一些通用的、**可编程的硬件**（电脑、手机、家具。。。）互联而成，而这些硬件并非专门用来实现某一特定目的。、
*  几种不同的类别的网络：
   *  不同作用范围的网络（从大到小）
      *  广域网 WAN (Wide Area Network)
      *  城域网 MAN (Metropolitan Area Network)
      *  局域网 LAN (Local Area Network)
      *  个人区域网 PAN (Personal Area Network)
   *   从网络的使用者进行分类
       *  公用网 (public network) 
            正常的上网
       *  专用网 (private network)
            如校园网，军事网络
   * 按拓扑结构分类
     *  计算机网络的拓扑结构
        *   是引用拓扑学中研究与大小、形状无关的点、线关系的方法，把网络中的计算机和通信设备抽象为一个点，把传输介质抽象为一条线，由点和线组成的几何图形就是计算机网络的拓扑结构。
    *   常见拓扑结构
         *  星形、树形
         *  环形
         *  网状
         *  混合型、蜂窝
![](2022-03-11-15-45-36.png)

* 把用户接入到互联网的网络
  * **接入网** **AN** (Access Network)，它又称为本地接入网或居民接入网。
  *  由 ISP 提供的接入网只是起到让用户能够与互联网连接的“桥梁”作用。

## 1.6 计算机网络的性能指标
1. 速率
   * 比特（bit）是计算机中数据量的单位，也是信息论中使用的信息量的单位。
   * Bit 来源于 binary digit，是一个“二进制数字”，一个比特就是二进制数字中的一个 1 或 0。
   * *速率即数据率*(data rate)或*比特率*(bit rate)，是计算机网络中最重要的一个性能指标。速率的单位是 b/s(bit per second)，或kb/s, Mb/s, Gb/s 等
   * 速率往往是指*额定速率或标称速率*。
2. 带宽
   * “带宽”(bandwidth)本来是指信号具有的频带宽度，单位是赫（或千赫、兆赫、吉赫等）。
   * 现在“带宽”是数字信道所能传送的“**最高数据率**”的同义语，单位是“比特每秒”，或b/s (bit/s)。
   * 更常用的带宽单位是
     * 千比每秒，即 Kb/s （103 b/s）
     * 兆比每秒，即 Mb/s（106 b/s）
     * 吉比每秒，即 Gb/s（109 b/s）
     * 太比每秒，即 Tb/s（1012 b/s）
   * 数字信号流随时间的变化
     * 在时间轴上信号的宽度随带宽的增大而变窄。
  ![](2022-03-11-15-52-31.png)
3. 吞吐量
   * **吞吐量**(throughput)表示在*单位时间内*通过*某个网络*（或信道、接口,而不是单条线路）的数据量。
   * 吞吐量经常地被用于对现实世界中的网络的一种测量，以便知道实际上到底有多少数据量能够通过网络。
   * 吞吐量受网络的带宽或网络的额定速率的限制。
4. 时延(delay 或 latency)
   * **发送时延**（传输时延）发送数据时，数据块从结点进入到传输媒体所需要的时间。
     * 也就是从发送数据帧的第一个比特算起，到该帧的最后一个比特发送完毕所需的时间。（因为使用串行发送方式）
$$
发送时延=\frac{数据块长度（比特）}{发送速率（比特/秒）}
$$
   * **传播时延** 电磁波在信道中需要传播一定的距离而花费的时间。
     * 信号传输速率（即发送速率）和信号在信道上的传播速率是完全不同的概念。
$$
传播时延=\frac{信道长度（米）}{信号在信道上的传播速率（米/秒）}
$$
   * **处理时延** 交换结点为存储转发而进行一些必要的处理所花费的时间。取决于路由器的性能
   * **排队时延** 结点缓存队列中分组排队所经历的时延。
     * 排队时延的长短往往取决于网络中当时的通信量。

* **总时延** = 发送时延+传播时延+处理时延+排队时延
![](2022-03-11-16-04-30.png)
> 带宽越宽，时延越小？
 带宽越宽，传播速度越大？
 不一定，带有很多其他因素

5. 时延带宽积
$$
时延带宽积 = 传播时延 \times 带宽
$$
*  链路的时延带宽积又称为以比特为单位的链路长度。
![](2022-03-11-16-08-07.png)
6. 往返时间
   * 往返时间 Round Trip Time（**RTT**）
   * 与*发送时延、传播时延、处理时延和排队时延*都有关系
   * RTT可以帮我们考虑“如果发送端连续发送数据，接收端一接收到数据就立即发送确认，则当发送端接收到 确认时，有多少数据已经在路上了？”
7. 利用率
   * **信道利用率**指出某信道有百分之几的时间是被利用的（有数据通过）。完全空闲的信道的利用率是零。
   * **网络利用率**则是全网络的信道利用率的加权平均值。
   * 信道利用率**并非**越高越好。(很高的时候，意味着空闲的信道很少，用户的上网体验会很差)
* 时延与网络利用率的关系
  * 根据排队论的理论，当某信道的利用率增大时，该信道引起的时延也就迅速增加。
  * 若令 D0 表示网络空闲时的时延，D 表示网络当前的时延，则在适当的假定条件下，可以用下面的简单公式表示 D 和 D0之间的关系：
$$
D=\frac{D_0}{1-U}
$$
>U 是网络的利用率，数值在 0 到 1 之间。
一般，利用率不能高于0.6   Q怎么算的，什么意思

![](2022-03-11-16-12-58.png)


* 计算机网络的**非性能**特征
  * 费用
  * 质量
  * 标准化
  * 可靠性
  * 可扩展性和可升级性
  * 易于管理和维护

## 1.7 计算机网络的体系结构
* 相互通信的两个计算机系统必须*高度协调工作*才行，而这种“**协调**”是相当复杂的。
* “*分层*”可将庞大而复杂的问题，转化为若干较小的局部问题，而这些较小的局部问题就比较易于研究和处理。
* 划分层次的必要性
  * 计算机网络中的数据交换**必须遵守事先约定好的规则**。
  * 这些**规则**明确规定了所交换的数据的格式以及有关的同步问题（同步含有时序的意思）。
  * **网络协议**(network protocol)，简称为协议，是为进行网络中的数据交换而建立的规则、标准或约定。
* 关于开放系统互连参考模型OSI/RM
  * 只要遵循 OSI 标准，一个系统就可以和位于世界上任何地方的、也遵循这同一标准的其他任何系统进行通信。
  * 在市场化方面 OSI 却失败了。
    * OSI 的专家们在完成 OSI 标准时没有商业驱动力；
    * OSI 的协议实现起来过分复杂，且运行效率很低；
    * OSI 标准的制定周期太长，因而使得按 OSI 标准生产的设备无法及时进入市场；
    * OSI 的层次划分并也不太合理，有些功能在多个层次中重复出现。
* 两种国际标准
  * 法律上的国际标准 OSI 并没有得到市场的认可。
  * 是非国际标准 TCP/IP 现在获得了最广泛的应用。
    * TCP/IP 常被称为事实上的(de facto) 国际标准。
![](2022-03-11-16-29-48.png)
* 分层的好处
  * 各层之间是独立的。
  * 灵活性好。
  * 结构上可分割开。
  * 易于实现和维护。
  * 能促进标准化工作。
* 网络协议的组成要素(重要)
  * **语法** 数据与控制信息的结构或格式 。
  * **语义** 需要发出何种控制信息，完成何种动作以及做出何种响应。
  * **同步** 事件实现顺序的详细说明。
* 划分层次的概念举例
  * 主机 1 向主机 2 通过网络发送文件。
  * 可以将要做的工作进行如下的划分。
  * 第一类工作与传送文件直接有关。
    * 确信对方已做好接收和存储文件的准备。
    * 双方协调好一致的文件格式。
  * 两个主机将*文件传送模块*作为最高的一层 。剩下的工作由下面的模块负责。
![](2022-03-11-16-39-46.png)
![](2022-03-11-16-40-07.png)
![](2022-03-11-16-40-25.png)
> 若层数太少，就会使每一层的协议太复杂。
 层数太多又会在描述和综合各层功能的系统工程任务时遇到较多的困难。

* 各层基本功能（每一层都应包含这些功能）
  * 差错控制（可能出现传输错误）
  * 流量控制（计算消耗多少流量，用来收费啊之类）
  * 分段和重装（原信息的拆分和重装）
  * 复用和分用（如电话线同时能进行上网和打电话，高低频分开用）
  * 建立连接和释放
* 计算机网络的体系结构
  * 计算机网络的**体系结构**(architecture)是计算机网络的各层及其协议的集合。
  * 体系结构就是这个计算机网络及其部件所应完成的功能的**精确定义**。
  * **实现**(implementation)是遵循这种体系结构的前提下用何种硬件或软件完成这些功能的问题。
  * 体系结构是抽象的，而实现则是具体的，是真正在运行的计算机硬件和软件。

### 1.7.3 具有五层协议的体系结构
* TCP/IP 是四层的体系结构：应用层、运输层、网际层和网络接口层。
* 但最下面的网络接口层并没有具体内容。
* 因此往往采取折中的办法，即综合 OSI 和TCP/IP 的优点，采用一种只有五层协议的体系结构 。
  ![](2022-03-11-17-03-57.png)
![](2022-03-11-17-06-34.png)
>PDU(协议数据单元)在每一层的名称：
应用层： 消息/应用层报文 message
传输层： 报文段/用户数据报 segment / user datagram
网络层： 包/IP数据报 package/IP datagram
数据链路层： 帧 frame
物理层： 比特流、码流 bit stream

### 1.7.4 实体、协议、服务和服务访问点
* **实体**(entity) 表示任何可发送或接收信息的硬件或软件进程。
* 协议是控制**两个对等实体**进行通信的规则的集合。
* 在协议的控制下，两个对等实体间的通信使得本层能够**向上一层提供务**。
* 要实现本层协议，还需要使用**下层**所提供的服务。
* 本层的服务用户只能看见服务而无法看见下面的协议。
* 下面的协议对上面的服务用户是**透明**的。
* 协议是“**水平的**”，即协议是控制对等实体之间通信的规则。
* 服务是“**垂直的**”，即服务是由下层向上层通过层间接口提供的。
* 同一系统相邻两层的实体进行交互的地方，称为**服务访问点 SAP** (Service Access Point)。
![](2022-03-11-17-15-01.png)
* 协议很复杂
  * 协议必须把**所有不利的条件**事先都估计到，而不能假定一切都是正常的和非常理想的。
  * 看一个计算机网络协议是否正确，不能光看在正常情况下是否正确，而且还必须非常仔细地检查这个协议**能否应付各种异常情况**。
  * 如：数据丢失时，仅仅发送丢失的部分还是全部重新发送，取决于协议

### 1.7.5 TCP/IP的体系结构
* 路由器在转发分组时最高只用到网络层而没有使用运输层和应用层。
![](2022-03-11-17-22-36.png)
![](2022-03-11-17-23-06.png)